#!/bin/sh
#RCUPDATE:3 4:72:This line is required for script management

. /etc/rc.d/config/functions

SERVICE=xinetd
opts="start stop"

autoconfig() {
	if [ ! -e /etc/xinetd.conf ] ; then
		if [ ! -e /etc/inetd.conf ] ; then
			eerror "You need an /etc/xinetd.conf file to run xinetd!"
			eerror "There are samples in docs/xinetd, docs/netkit-base"
			exit 1
		else
			einfo "Auto-creating xinetd.conf from your inetd.conf.."
			/usr/sbin/xconv.pl < /etc/inetd.conf > /etc/xinetd.conf
		fi
	fi
}

start() {
	autoconfig
	ebegin "Starting supervised ${SERVICE}"
	ln -sf ../services/${SERVICE} ${SVCDIR}/control/${SERVICE}
	eend $?
}

stop() {
	ebegin "Stopping supervised ${SERVICE}"
	if [ -e ${SVCDIR}/control/${SERVICE} ]
	then
		/usr/bin/svc -dx ${SVCDIR}/control/${SERVICE}
		rm ${SVCDIR}/control/${SERVICE}
	fi
	eend $?
}

doservice ${@}
