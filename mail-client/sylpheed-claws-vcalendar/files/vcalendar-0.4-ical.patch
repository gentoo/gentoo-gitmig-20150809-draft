--- src/vcal_manager.c.org	2004-09-22 15:08:20.000000000 +0200
+++ src/vcal_manager.c	2004-10-07 21:40:33.522688052 +0200
@@ -326,8 +326,8 @@
 			icalproperty_new_description(event->description),
 			icalproperty_new_summary(event->summary),
 			icalproperty_new_sequence(event->sequence + 1),
-			icalproperty_new_class("PUBLIC"),
-			icalproperty_new_transp("OPAQUE"),
+			icalproperty_new_class(ICAL_CLASS_PUBLIC),
+			icalproperty_new_transp(ICAL_TRANSP_OPAQUE),
                 	orgprop,
                 	0
                 	);
@@ -440,11 +440,15 @@
 	event->uid 		= g_strdup(uid?uid:"");
 	event->organizer 	= g_strdup(organizer?organizer:"");
 
-	if (dtend) 
-		event->end	= g_strdup(icaltime_as_ctime(icaltime_as_local(icaltime_from_string(dtend))));
+	if (dtend) {
+		time_t tmp = icaltime_as_timet(icaltime_as_local(icaltime_from_string(dtend)));
+		event->end	= g_strdup(ctime(&tmp));
+	}
 	
-	if (dtstart)
-		event->start	= g_strdup(icaltime_as_ctime(icaltime_as_local(icaltime_from_string(dtstart))));
+	if (dtstart) {
+		time_t tmp = icaltime_as_timet(icaltime_as_local(icaltime_from_string(dtstart)));
+		event->start	= g_strdup(ctime(&tmp));
+	}
 
 	event->dtstart		= g_strdup(dtstart?dtstart:"");
 	event->dtend		= g_strdup(dtend?dtend:"");
--- src/vcalendar.c.org	2004-09-22 15:08:20.000000000 +0200
+++ src/vcalendar.c	2004-10-07 21:38:29.549822328 +0200
@@ -720,8 +720,8 @@
 	iprop = vcalviewer_get_property(vcalviewer, ICAL_DTSTART_PROPERTY);
 	if (iprop) {
 		struct icaltimetype itt = icaltime_as_local(icalproperty_get_dtstart(iprop));
-		gtk_label_set_text(GTK_LABEL(vcalviewer->start), 
-			icaltime_as_ctime(itt));
+		time_t tmp = icaltime_as_timet(itt);
+		gtk_label_set_text(GTK_LABEL(vcalviewer->start), ctime(&tmp));
 		icalproperty_free(iprop);
 	} else
 		gtk_label_set_text(GTK_LABEL(vcalviewer->start), "-");
@@ -729,8 +729,8 @@
 	iprop = vcalviewer_get_property(vcalviewer, ICAL_DTEND_PROPERTY);
 	if (iprop) {
 		struct icaltimetype itt = icaltime_as_local(icalproperty_get_dtstart(iprop));
-		gtk_label_set_text(GTK_LABEL(vcalviewer->end), 
-			icaltime_as_ctime(itt));
+		time_t tmp = icaltime_as_timet(itt);
+		gtk_label_set_text(GTK_LABEL(vcalviewer->end), ctime(&tmp));
 		icalproperty_free(iprop);
 	} else
 		gtk_label_set_text(GTK_LABEL(vcalviewer->end), "-");
