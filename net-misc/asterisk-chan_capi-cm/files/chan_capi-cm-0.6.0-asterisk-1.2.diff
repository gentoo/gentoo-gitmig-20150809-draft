--- chan_capi-cm-0.6/chan_capi.c.orig	2005-09-20 18:40:15 +0000
+++ chan_capi-cm-0.6/chan_capi.c	2005-12-21 22:56:57 +0000
@@ -18,6 +18,17 @@
 
 #include "config.h"
 
+#include <sys/time.h>
+#include <sys/signal.h>
+#include <stdlib.h>
+#include <stdio.h>
+#include <string.h>
+#include <ctype.h>
+#include <errno.h>
+#include <unistd.h>
+#include <fcntl.h>
+#include <sys/types.h>
+
 #include <asterisk/lock.h>
 #include <asterisk/frame.h> 
 #include <asterisk/channel.h>
@@ -33,16 +44,6 @@
 #include <asterisk/utils.h>
 #include <asterisk/cli.h>
 #include <asterisk/causes.h>
-#include <sys/time.h>
-#include <sys/signal.h>
-#include <stdlib.h>
-#include <stdio.h>
-#include <string.h>
-#include <ctype.h>
-#include <errno.h>
-#include <unistd.h>
-#include <fcntl.h>
-#include <sys/types.h>
 #include <asterisk/dsp.h>
 #include "xlaw.h"
 #include "chan_capi20.h"
@@ -4011,7 +4012,7 @@
 		}
 		memset(tmp, 0, sizeof(struct ast_capi_pvt));
 		
-		ast_pthread_mutex_init(&(tmp->lock),NULL);
+		ast_mutex_init(&(tmp->lock));
 		
 		strncpy(tmp->name, conf->name, sizeof(tmp->name) - 1);
 		strncpy(tmp->context, conf->context, sizeof(tmp->context) - 1);
