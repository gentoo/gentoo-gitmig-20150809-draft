#!/bin/bash
progname="skype"
progpath="/opt/${progname}/"
shellcheck1=` which artsshell 2> /dev/null `
shellcheck2=` which esd 2> /dev/null `
artsdcheck=` ps x | grep artsd | grep -v grep `
esdcheck=` ps x | grep "esd ." | grep -v grep `

if [[ -z ${shellcheck1} && -z ${shellcheck2} ]]
then
	echo "No installed artsshell or esd found"
	echo "Assuming you're running no sound daemon"
	echo "Starting ${progname} without a sound wrapper"
	${progpath}/${progname}.bin
				
else
	if [[ ${shellcheck1} == ${KDEDIR}/bin/artsshell && -n ${artsdcheck} ]]
	then
		echo "Running artsd found"
		echo "Starting artsd wrapped ${progname}"
		artsdsp -m ${progpath}/${progname}.bin

	elif [[ ${shellcheck2} == /usr/bin/esd && -n ${esdcheck} ]]
	then
		echo "Running esd found"
                echo "Starting esd wrapped ${progname}"
		esddsp ${progpath}/${progname}.bin
	else
		echo "No running artsd or esd found"
		echo "Starting ${progname} without sound daemon"
		${progpath}/${progname}.bin
	fi
	
fi
exit 0
